"use strict";
var nomnom = require("nomnom");
var path = require("path");
var ProjectInitialiser_1 = require("../core/ProjectInitialiser");
var Logger_1 = require("./Logger");
var Blitz_1 = require("../Blitz");
var Config_1 = require("../components/Config");
var SiteGenerator_1 = require("../core/SiteGenerator");
var Util_1 = require("../helpers/Util");
exports.CLI_NAME = 'blitz';
var CLI = (function () {
    function CLI() {
    }
    CLI.run = function (argv) {
        var parser = nomnom();
        global.debug = false;
        global.verbose = false;
        parser.script(exports.CLI_NAME);
        parser.nocommand().callback(function () { return CLI.version(); });
        parser.option('verbose', {
            abbr: 'v',
            flag: true,
            help: 'displays warnings and log output',
            callback: function (flagSet) { return global.verbose = flagSet; },
        });
        parser.option('debug', {
            abbr: 'd',
            flag: true,
            help: 'displays debug output',
            callback: function (flagSet) { return global.debug = flagSet; },
        });
        parser.command('init')
            .option('template', {
            abbr: 't',
            default: ProjectInitialiser_1.DEFAULT_TEMPLATE,
            help: 'template name',
        })
            .option('path', {
            abbr: 'p',
            default: process.cwd(),
            help: 'path to project folder',
        })
            .help('initialise a project from template')
            .callback(function (opts) { return Blitz_1.Blitz.init(opts.template, opts.path); });
        parser.command('build')
            .option('config', {
            abbr: 'c',
            default: path.join(process.cwd(), Config_1.DEFAULT_CONFIG_NAME),
            help: 'path to Blitz config',
        })
            .option('build', {
            abbr: 'b',
            default: path.join(process.cwd(), SiteGenerator_1.DEFAULT_BUILD_DIRECTORY_NAME),
            help: 'path to target build directory',
        })
            .help('builds site using `blitz.yml`')
            .callback(function (opts) { return Blitz_1.Blitz.build(opts.config, opts.build); });
        parser.command('watch')
            .option('config', {
            abbr: 'c',
            default: path.join(process.cwd(), Config_1.DEFAULT_CONFIG_NAME),
            help: 'path to Blitz config',
        })
            .option('build', {
            abbr: 'b',
            default: path.join(process.cwd(), SiteGenerator_1.DEFAULT_BUILD_DIRECTORY_NAME),
            help: 'path to target build directory',
        })
            .help('watches source code and rebuilds the website when necessary')
            .callback(function (opts) {
            global.verbose = true;
            Blitz_1.Blitz.watch(opts.config, opts.build);
        });
        parser.command('preview')
            .option('config', {
            abbr: 'c',
            default: path.join(process.cwd(), Config_1.DEFAULT_CONFIG_NAME),
            help: 'path to Blitz config',
        })
            .option('build', {
            abbr: 'b',
            default: path.join(process.cwd(), SiteGenerator_1.DEFAULT_BUILD_DIRECTORY_NAME),
            help: 'path to target build directory',
        })
            .help('starts a web server for real-time change preview')
            .callback(function (opts) {
            global.verbose = true;
            Blitz_1.Blitz.preview(opts.config, opts.build);
        });
        var normalisedArgv = argv.slice(2);
        exports.args = parser.parse(normalisedArgv);
    };
    CLI.version = function () {
        var verboseState = global.verbose;
        global.verbose = true;
        Logger_1.Logger.log('Blitz v' + Util_1.Util.getPackageInfo().version + ', use `' + Logger_1.Logger.brand('blitz -h') + '` for help');
        Logger_1.Logger.log('For documentation, refer to ' + Logger_1.Logger.brand('https://getblitz.io/'));
        global.verbose = verboseState;
    };
    return CLI;
}());
exports.CLI = CLI;

//# sourceMappingURL=data:application/json;charset=utf8;base64,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YUFBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUMzQyxDQUFDLENBQUMsQ0FBQztRQUVQLElBQUksY0FBYyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbkMsWUFBSSxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDeEMsQ0FBQztJQU1hLFdBQU8sR0FBckI7UUFDSSxJQUFJLFlBQVksR0FBRyxNQUFNLENBQUMsT0FBTyxDQUFDO1FBQ2xDLE1BQU0sQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDO1FBQ3RCLGVBQU0sQ0FBQyxHQUFHLENBQUMsU0FBUyxHQUFHLFdBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQyxPQUFPLEdBQUcsU0FBUyxHQUFHLGVBQU0sQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLEdBQUcsWUFBWSxDQUFDLENBQUM7UUFDNUcsZUFBTSxDQUFDLEdBQUcsQ0FBQyw4QkFBOEIsR0FBRyxlQUFNLENBQUMsS0FBSyxDQUFDLHNCQUFzQixDQUFDLENBQUMsQ0FBQztRQUNsRixNQUFNLENBQUMsT0FBTyxHQUFHLFlBQVksQ0FBQztJQUNsQyxDQUFDO0lBQ0wsVUFBQztBQUFELENBbkdBLEFBbUdDLElBQUE7QUFuR1ksa0JBQUciLCJmaWxlIjoic3JjL2NsaS9DTEkuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBmaWxlIENvbnRhaW5zIGNvZGUgcmVzcG9uc2libGUgZm9yIHJvdXRpbmcgYGJsaXR6YCBDTEkgY29tbWFuZHMgdG8gdGhlIGBibGl0emAgbW9kdWxlXG4gKiBAYXV0aG9yIFRpbXVyIEt1emhhZ2FsaXlldiA8dGltLmt1emhAZ21haWwuY29tPlxuICogQGNvcHlyaWdodCAyMDE2XG4gKiBAbGljZW5zZSBHUEwtMy4wXG4gKiBAc2luY2UgMC4yLjBcbiAqL1xuXG5pbXBvcnQgKiBhcyBub21ub20gZnJvbSAnbm9tbm9tJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQge0RFRkFVTFRfVEVNUExBVEV9IGZyb20gJy4uL2NvcmUvUHJvamVjdEluaXRpYWxpc2VyJztcbmltcG9ydCB7TG9nZ2VyfSBmcm9tICcuL0xvZ2dlcic7XG5pbXBvcnQge0JsaXR6fSBmcm9tICcuLi9CbGl0eic7XG5pbXBvcnQge0RFRkFVTFRfQ09ORklHX05BTUV9IGZyb20gJy4uL2NvbXBvbmVudHMvQ29uZmlnJztcbmltcG9ydCB7REVGQVVMVF9CVUlMRF9ESVJFQ1RPUllfTkFNRX0gZnJvbSAnLi4vY29yZS9TaXRlR2VuZXJhdG9yJztcbmltcG9ydCB7VXRpbH0gZnJvbSAnLi4vaGVscGVycy9VdGlsJztcblxuLyoqXG4gKiBOYW1lIG9mIHRoZSBjbGkgY29tbWFuZCB1c2VkIHRvIHJ1biBCbGl0elxuICogQHNpbmNlIDAuMi4wXG4gKi9cbmV4cG9ydCBjb25zdCBDTElfTkFNRSA9ICdibGl0eic7XG5cbi8qKlxuICogUGFyc2VkIGFyZ3VtZW50c1xuICogQHNpbmNlIDAuMi4wXG4gKi9cbmV4cG9ydCBsZXQgYXJncztcblxuLyoqXG4gKiBAY2xhc3MgRXhwb3NlcyBhbiBBUEkgZm9yIHRoZSBjbGlcbiAqIEBzaW5jZSAwLjIuMFxuICovXG5leHBvcnQgY2xhc3MgQ0xJIHtcbiAgICAvKipcbiAgICAgKiBQYXJzZXMgY29tbWFuZCBsaW5lIGFyZ3VtZW50cyBhbmQgcnVucyByZWxldmFudCBtZXRob2RzXG4gICAgICogQHNpbmNlIDAuMi4wXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyBydW4oYXJndjogc3RyaW5nW10pIHtcbiAgICAgICAgbGV0IHBhcnNlciA9IG5vbW5vbSgpO1xuXG4gICAgICAgIGdsb2JhbC5kZWJ1ZyA9IGZhbHNlO1xuICAgICAgICBnbG9iYWwudmVyYm9zZSA9IGZhbHNlO1xuXG4gICAgICAgIHBhcnNlci5zY3JpcHQoQ0xJX05BTUUpO1xuICAgICAgICBwYXJzZXIubm9jb21tYW5kKCkuY2FsbGJhY2soKCkgPT4gQ0xJLnZlcnNpb24oKSk7XG4gICAgICAgIHBhcnNlci5vcHRpb24oJ3ZlcmJvc2UnLCB7XG4gICAgICAgICAgICBhYmJyOiAndicsXG4gICAgICAgICAgICBmbGFnOiB0cnVlLFxuICAgICAgICAgICAgaGVscDogJ2Rpc3BsYXlzIHdhcm5pbmdzIGFuZCBsb2cgb3V0cHV0JyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoZmxhZ1NldCkgPT4gZ2xvYmFsLnZlcmJvc2UgPSBmbGFnU2V0LFxuICAgICAgICB9KTtcbiAgICAgICAgcGFyc2VyLm9wdGlvbignZGVidWcnLCB7XG4gICAgICAgICAgICBhYmJyOiAnZCcsXG4gICAgICAgICAgICBmbGFnOiB0cnVlLFxuICAgICAgICAgICAgaGVscDogJ2Rpc3BsYXlzIGRlYnVnIG91dHB1dCcsXG4gICAgICAgICAgICBjYWxsYmFjazogKGZsYWdTZXQpID0+IGdsb2JhbC5kZWJ1ZyA9IGZsYWdTZXQsXG4gICAgICAgIH0pO1xuICAgICAgICBwYXJzZXIuY29tbWFuZCgnaW5pdCcpXG4gICAgICAgICAgICAub3B0aW9uKCd0ZW1wbGF0ZScsIHtcbiAgICAgICAgICAgICAgICBhYmJyOiAndCcsXG4gICAgICAgICAgICAgICAgZGVmYXVsdDogREVGQVVMVF9URU1QTEFURSxcbiAgICAgICAgICAgICAgICBoZWxwOiAndGVtcGxhdGUgbmFtZScsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLm9wdGlvbigncGF0aCcsIHtcbiAgICAgICAgICAgICAgICBhYmJyOiAncCcsXG4gICAgICAgICAgICAgICAgZGVmYXVsdDogcHJvY2Vzcy5jd2QoKSxcbiAgICAgICAgICAgICAgICBoZWxwOiAncGF0aCB0byBwcm9qZWN0IGZvbGRlcicsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmhlbHAoJ2luaXRpYWxpc2UgYSBwcm9qZWN0IGZyb20gdGVtcGxhdGUnKVxuICAgICAgICAgICAgLmNhbGxiYWNrKChvcHRzKSA9PiBCbGl0ei5pbml0KG9wdHMudGVtcGxhdGUsIG9wdHMucGF0aCkpO1xuICAgICAgICBwYXJzZXIuY29tbWFuZCgnYnVpbGQnKVxuICAgICAgICAgICAgLm9wdGlvbignY29uZmlnJywge1xuICAgICAgICAgICAgICAgIGFiYnI6ICdjJyxcbiAgICAgICAgICAgICAgICBkZWZhdWx0OiBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgREVGQVVMVF9DT05GSUdfTkFNRSksXG4gICAgICAgICAgICAgICAgaGVscDogJ3BhdGggdG8gQmxpdHogY29uZmlnJyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAub3B0aW9uKCdidWlsZCcsIHtcbiAgICAgICAgICAgICAgICBhYmJyOiAnYicsXG4gICAgICAgICAgICAgICAgZGVmYXVsdDogcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIERFRkFVTFRfQlVJTERfRElSRUNUT1JZX05BTUUpLFxuICAgICAgICAgICAgICAgIGhlbHA6ICdwYXRoIHRvIHRhcmdldCBidWlsZCBkaXJlY3RvcnknLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5oZWxwKCdidWlsZHMgc2l0ZSB1c2luZyBgYmxpdHoueW1sYCcpXG4gICAgICAgICAgICAuY2FsbGJhY2soKG9wdHMpID0+IEJsaXR6LmJ1aWxkKG9wdHMuY29uZmlnLCBvcHRzLmJ1aWxkKSk7XG4gICAgICAgIHBhcnNlci5jb21tYW5kKCd3YXRjaCcpXG4gICAgICAgICAgICAub3B0aW9uKCdjb25maWcnLCB7XG4gICAgICAgICAgICAgICAgYWJicjogJ2MnLFxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCBERUZBVUxUX0NPTkZJR19OQU1FKSxcbiAgICAgICAgICAgICAgICBoZWxwOiAncGF0aCB0byBCbGl0eiBjb25maWcnLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5vcHRpb24oJ2J1aWxkJywge1xuICAgICAgICAgICAgICAgIGFiYnI6ICdiJyxcbiAgICAgICAgICAgICAgICBkZWZhdWx0OiBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgREVGQVVMVF9CVUlMRF9ESVJFQ1RPUllfTkFNRSksXG4gICAgICAgICAgICAgICAgaGVscDogJ3BhdGggdG8gdGFyZ2V0IGJ1aWxkIGRpcmVjdG9yeScsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmhlbHAoJ3dhdGNoZXMgc291cmNlIGNvZGUgYW5kIHJlYnVpbGRzIHRoZSB3ZWJzaXRlIHdoZW4gbmVjZXNzYXJ5JylcbiAgICAgICAgICAgIC5jYWxsYmFjaygob3B0cykgPT4ge1xuICAgICAgICAgICAgICAgIGdsb2JhbC52ZXJib3NlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBCbGl0ei53YXRjaChvcHRzLmNvbmZpZywgb3B0cy5idWlsZCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgcGFyc2VyLmNvbW1hbmQoJ3ByZXZpZXcnKVxuICAgICAgICAgICAgLm9wdGlvbignY29uZmlnJywge1xuICAgICAgICAgICAgICAgIGFiYnI6ICdjJyxcbiAgICAgICAgICAgICAgICBkZWZhdWx0OiBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgREVGQVVMVF9DT05GSUdfTkFNRSksXG4gICAgICAgICAgICAgICAgaGVscDogJ3BhdGggdG8gQmxpdHogY29uZmlnJyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAub3B0aW9uKCdidWlsZCcsIHtcbiAgICAgICAgICAgICAgICBhYmJyOiAnYicsXG4gICAgICAgICAgICAgICAgZGVmYXVsdDogcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIERFRkFVTFRfQlVJTERfRElSRUNUT1JZX05BTUUpLFxuICAgICAgICAgICAgICAgIGhlbHA6ICdwYXRoIHRvIHRhcmdldCBidWlsZCBkaXJlY3RvcnknLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5oZWxwKCdzdGFydHMgYSB3ZWIgc2VydmVyIGZvciByZWFsLXRpbWUgY2hhbmdlIHByZXZpZXcnKVxuICAgICAgICAgICAgLmNhbGxiYWNrKChvcHRzKSA9PiB7XG4gICAgICAgICAgICAgICAgZ2xvYmFsLnZlcmJvc2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIEJsaXR6LnByZXZpZXcob3B0cy5jb25maWcsIG9wdHMuYnVpbGQpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgbGV0IG5vcm1hbGlzZWRBcmd2ID0gYXJndi5zbGljZSgyKTtcbiAgICAgICAgYXJncyA9IHBhcnNlci5wYXJzZShub3JtYWxpc2VkQXJndik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJpbnRzIGluZm9ybWF0aW9uIGFib3V0IHRoZSB2ZXJzaW9uXG4gICAgICogQHNpbmNlIDAuMi4wXG4gICAgICovXG4gICAgcHVibGljIHN0YXRpYyB2ZXJzaW9uKCkge1xuICAgICAgICBsZXQgdmVyYm9zZVN0YXRlID0gZ2xvYmFsLnZlcmJvc2U7XG4gICAgICAgIGdsb2JhbC52ZXJib3NlID0gdHJ1ZTtcbiAgICAgICAgTG9nZ2VyLmxvZygnQmxpdHogdicgKyBVdGlsLmdldFBhY2thZ2VJbmZvKCkudmVyc2lvbiArICcsIHVzZSBgJyArIExvZ2dlci5icmFuZCgnYmxpdHogLWgnKSArICdgIGZvciBoZWxwJyk7XG4gICAgICAgIExvZ2dlci5sb2coJ0ZvciBkb2N1bWVudGF0aW9uLCByZWZlciB0byAnICsgTG9nZ2VyLmJyYW5kKCdodHRwczovL2dldGJsaXR6LmlvLycpKTtcbiAgICAgICAgZ2xvYmFsLnZlcmJvc2UgPSB2ZXJib3NlU3RhdGU7XG4gICAgfVxufVxuIl19
