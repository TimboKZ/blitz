"use strict";
var path = require("path");
var browserSync = require("browser-sync");
var ProjectWatcher_1 = require("./ProjectWatcher");
var ProjectPreviewer = (function () {
    function ProjectPreviewer(configPath, buildPath, eventEmitter) {
        this.configPath = configPath;
        this.buildPath = buildPath;
        this.eventEmitter = eventEmitter;
        this.server = browserSync.create();
    }
    ProjectPreviewer.prototype.startServer = function () {
        var _this = this;
        var projectWatcher = new ProjectWatcher_1.ProjectWatcher(this.configPath, this.buildPath, this.eventEmitter);
        projectWatcher.watch();
        this.server.init({
            server: this.buildPath,
            logPrefix: '> Preview',
        });
        this.eventEmitter.on(ProjectWatcher_1.BUILD_CHANGE_EVENT, function (filePath) {
            _this.server.reload(path.join(_this.buildPath, filePath));
        });
    };
    return ProjectPreviewer;
}());
exports.ProjectPreviewer = ProjectPreviewer;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9Qcm9qZWN0UHJldmlld2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFRQSwyQkFBNkI7QUFDN0IsMENBQTRDO0FBRTVDLG1EQUFvRTtBQU9wRTtJQTRCSSwwQkFBWSxVQUFrQixFQUFFLFNBQWlCLEVBQUUsWUFBMEI7UUFDekUsSUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7UUFDN0IsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7UUFDM0IsSUFBSSxDQUFDLFlBQVksR0FBRyxZQUFZLENBQUM7UUFDakMsSUFBSSxDQUFDLE1BQU0sR0FBRyxXQUFXLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDdkMsQ0FBQztJQU1NLHNDQUFXLEdBQWxCO1FBQUEsaUJBVUM7UUFURyxJQUFJLGNBQWMsR0FBRyxJQUFJLCtCQUFjLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUM1RixjQUFjLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDdkIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUM7WUFDYixNQUFNLEVBQUUsSUFBSSxDQUFDLFNBQVM7WUFDdEIsU0FBUyxFQUFFLFdBQVc7U0FDekIsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLFlBQVksQ0FBQyxFQUFFLENBQUMsbUNBQWtCLEVBQUUsVUFBQyxRQUFRO1lBQzlDLEtBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSSxDQUFDLFNBQVMsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDO1FBQzVELENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUNMLHVCQUFDO0FBQUQsQ0FsREEsQUFrREMsSUFBQTtBQWxEWSw0Q0FBZ0IiLCJmaWxlIjoic3JjL1Byb2plY3RQcmV2aWV3ZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBmaWxlIENvbnRhaW5zIGNvZGUgcmVzcG9uc2libGUgZm9yIGJ1aWxkaW5nLCB3YXRjaGluZyBhbmQgcHJldmlldyBzZXJ2ZXJcbiAqIEBhdXRob3IgVGltdXIgS3V6aGFnYWxpeWV2IDx0aW0ua3V6aEBnbWFpbC5jb20+XG4gKiBAY29weXJpZ2h0IDIwMTZcbiAqIEBsaWNlbnNlIEdQTC0zLjBcbiAqIEBzaW5jZSAwLjIuMFxuICovXG5cbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgKiBhcyBicm93c2VyU3luYyBmcm9tICdicm93c2VyLXN5bmMnO1xuaW1wb3J0IHtFdmVudEVtaXR0ZXJ9IGZyb20gJ2V2ZW50cyc7XG5pbXBvcnQge1Byb2plY3RXYXRjaGVyLCBCVUlMRF9DSEFOR0VfRVZFTlR9IGZyb20gJy4vUHJvamVjdFdhdGNoZXInO1xuaW1wb3J0IHtCcm93c2VyU3luY0luc3RhbmNlfSBmcm9tICdicm93c2VyLXN5bmMnO1xuXG4vKipcbiAqIEBjbGFzcyBDcmVhdGVzIGEgd2F0Y2hlZCBhbmQgYSBwcmV2aWV3IHNlcnZlclxuICogQHNpbmNlIDAuMi4wXG4gKi9cbmV4cG9ydCBjbGFzcyBQcm9qZWN0UHJldmlld2VyIHtcbiAgICAvKipcbiAgICAgKiBMb2NhdGlvbiBvZiB0aGUgY29uZmlnIHRoYXQgd2lsbCBiZSB1c2VkIGZvciBnZW5lcmF0aW9uIG9mIHRoZSB3ZWJzaXRlXG4gICAgICogQHNpbmNlIDAuMi4wXG4gICAgICovXG4gICAgcHJpdmF0ZSBjb25maWdQYXRoOiBzdHJpbmc7XG5cbiAgICAvKipcbiAgICAgKiBUYXJnZXQgYnVpbGQgcGF0aFxuICAgICAqIEBzaW5jZSAwLjIuMFxuICAgICAqL1xuICAgIHByaXZhdGUgYnVpbGRQYXRoOiBzdHJpbmc7XG5cbiAgICAvKipcbiAgICAgKiBJbmplY3RlZCBldmVudCBlbWl0dGVyIHJlZmVyZW5jZVxuICAgICAqIEBzaW5jZSAwLjIuMFxuICAgICAqL1xuICAgIHByaXZhdGUgZXZlbnRFbWl0dGVyOiBFdmVudEVtaXR0ZXI7XG5cbiAgICAvKipcbiAgICAgKiBAc2luY2UgMC4yLjBcbiAgICAgKi9cbiAgICBwcml2YXRlIHNlcnZlcjogQnJvd3NlclN5bmNJbnN0YW5jZTtcblxuICAgIC8qKlxuICAgICAqIFByb2plY3RXYXRjaGVyIGNvbnN0cnVjdG9yXG4gICAgICogQHNpbmNlIDAuMi4wXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoY29uZmlnUGF0aDogc3RyaW5nLCBidWlsZFBhdGg6IHN0cmluZywgZXZlbnRFbWl0dGVyOiBFdmVudEVtaXR0ZXIpIHtcbiAgICAgICAgdGhpcy5jb25maWdQYXRoID0gY29uZmlnUGF0aDtcbiAgICAgICAgdGhpcy5idWlsZFBhdGggPSBidWlsZFBhdGg7XG4gICAgICAgIHRoaXMuZXZlbnRFbWl0dGVyID0gZXZlbnRFbWl0dGVyO1xuICAgICAgICB0aGlzLnNlcnZlciA9IGJyb3dzZXJTeW5jLmNyZWF0ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICogQHNpbmNlIDAuMi4wXG4gICAgICovXG4gICAgcHVibGljIHN0YXJ0U2VydmVyKCkge1xuICAgICAgICBsZXQgcHJvamVjdFdhdGNoZXIgPSBuZXcgUHJvamVjdFdhdGNoZXIodGhpcy5jb25maWdQYXRoLCB0aGlzLmJ1aWxkUGF0aCwgdGhpcy5ldmVudEVtaXR0ZXIpO1xuICAgICAgICBwcm9qZWN0V2F0Y2hlci53YXRjaCgpO1xuICAgICAgICB0aGlzLnNlcnZlci5pbml0KHtcbiAgICAgICAgICAgIHNlcnZlcjogdGhpcy5idWlsZFBhdGgsXG4gICAgICAgICAgICBsb2dQcmVmaXg6ICc+IFByZXZpZXcnLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5ldmVudEVtaXR0ZXIub24oQlVJTERfQ0hBTkdFX0VWRU5ULCAoZmlsZVBhdGgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuc2VydmVyLnJlbG9hZChwYXRoLmpvaW4odGhpcy5idWlsZFBhdGgsIGZpbGVQYXRoKSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiJdfQ==
