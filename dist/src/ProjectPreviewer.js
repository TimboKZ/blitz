"use strict";
var path = require('path');
var browserSync = require('browser-sync');
var ProjectWatcher_1 = require('./ProjectWatcher');
var ProjectPreviewer = (function () {
    function ProjectPreviewer(configPath, buildPath, eventEmitter) {
        this.configPath = configPath;
        this.buildPath = buildPath;
        this.eventEmitter = eventEmitter;
        this.server = browserSync.create();
    }
    ProjectPreviewer.prototype.startServer = function () {
        var _this = this;
        var projectWatcher = new ProjectWatcher_1.ProjectWatcher(this.configPath, this.buildPath, this.eventEmitter);
        projectWatcher.watch();
        this.server.init({
            server: this.buildPath,
        });
        this.eventEmitter.on(ProjectWatcher_1.BUILD_CHANGE_EVENT, function (filePath) {
            _this.server.reload(path.join(_this.buildPath, filePath));
        });
    };
    return ProjectPreviewer;
}());
exports.ProjectPreviewer = ProjectPreviewer;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9Qcm9qZWN0UHJldmlld2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFRQSxJQUFZLElBQUksV0FBTSxNQUFNLENBQUMsQ0FBQTtBQUM3QixJQUFZLFdBQVcsV0FBTSxjQUFjLENBQUMsQ0FBQTtBQUU1QywrQkFBaUQsa0JBQWtCLENBQUMsQ0FBQTtBQU9wRTtJQTRCSSwwQkFBWSxVQUFrQixFQUFFLFNBQWlCLEVBQUUsWUFBMEI7UUFDekUsSUFBSSxDQUFDLFVBQVUsR0FBRyxVQUFVLENBQUM7UUFDN0IsSUFBSSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7UUFDM0IsSUFBSSxDQUFDLFlBQVksR0FBRyxZQUFZLENBQUM7UUFDakMsSUFBSSxDQUFDLE1BQU0sR0FBRyxXQUFXLENBQUMsTUFBTSxFQUFFLENBQUM7SUFDdkMsQ0FBQztJQU1NLHNDQUFXLEdBQWxCO1FBQUEsaUJBU0M7UUFSRyxJQUFJLGNBQWMsR0FBRyxJQUFJLCtCQUFjLENBQUMsSUFBSSxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUM1RixjQUFjLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDdkIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUM7WUFDYixNQUFNLEVBQUUsSUFBSSxDQUFDLFNBQVM7U0FDekIsQ0FBQyxDQUFDO1FBQ0gsSUFBSSxDQUFDLFlBQVksQ0FBQyxFQUFFLENBQUMsbUNBQWtCLEVBQUUsVUFBQyxRQUFRO1lBQzlDLEtBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSSxDQUFDLFNBQVMsRUFBRSxRQUFRLENBQUMsQ0FBQyxDQUFDO1FBQzVELENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUNMLHVCQUFDO0FBQUQsQ0FqREEsQUFpREMsSUFBQTtBQWpEWSx3QkFBZ0IsbUJBaUQ1QixDQUFBIiwiZmlsZSI6InNyYy9Qcm9qZWN0UHJldmlld2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBAZmlsZSBDb250YWlucyBjb2RlIHJlc3BvbnNpYmxlIGZvciBidWlsZGluZywgd2F0Y2hpbmcgYW5kIHByZXZpZXcgc2VydmVyXG4gKiBAYXV0aG9yIFRpbXVyIEt1emhhZ2FsaXlldiA8dGltLmt1emhAZ21haWwuY29tPlxuICogQGNvcHlyaWdodCAyMDE2XG4gKiBAbGljZW5zZSBHUEwtMy4wXG4gKiBAc2luY2UgMC4yLjBcbiAqL1xuXG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0ICogYXMgYnJvd3NlclN5bmMgZnJvbSAnYnJvd3Nlci1zeW5jJztcbmltcG9ydCB7RXZlbnRFbWl0dGVyfSBmcm9tICdldmVudHMnO1xuaW1wb3J0IHtQcm9qZWN0V2F0Y2hlciwgQlVJTERfQ0hBTkdFX0VWRU5UfSBmcm9tICcuL1Byb2plY3RXYXRjaGVyJztcbmltcG9ydCB7QnJvd3NlclN5bmNJbnN0YW5jZX0gZnJvbSAnYnJvd3Nlci1zeW5jJztcblxuLyoqXG4gKiBAY2xhc3MgQ3JlYXRlcyBhIHdhdGNoZWQgYW5kIGEgcHJldmlldyBzZXJ2ZXJcbiAqIEBzaW5jZSAwLjIuMFxuICovXG5leHBvcnQgY2xhc3MgUHJvamVjdFByZXZpZXdlciB7XG4gICAgLyoqXG4gICAgICogTG9jYXRpb24gb2YgdGhlIGNvbmZpZyB0aGF0IHdpbGwgYmUgdXNlZCBmb3IgZ2VuZXJhdGlvbiBvZiB0aGUgd2Vic2l0ZVxuICAgICAqIEBzaW5jZSAwLjIuMFxuICAgICAqL1xuICAgIHByaXZhdGUgY29uZmlnUGF0aDogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogVGFyZ2V0IGJ1aWxkIHBhdGhcbiAgICAgKiBAc2luY2UgMC4yLjBcbiAgICAgKi9cbiAgICBwcml2YXRlIGJ1aWxkUGF0aDogc3RyaW5nO1xuXG4gICAgLyoqXG4gICAgICogSW5qZWN0ZWQgZXZlbnQgZW1pdHRlciByZWZlcmVuY2VcbiAgICAgKiBAc2luY2UgMC4yLjBcbiAgICAgKi9cbiAgICBwcml2YXRlIGV2ZW50RW1pdHRlcjogRXZlbnRFbWl0dGVyO1xuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKi9cbiAgICBwcml2YXRlIHNlcnZlcjogQnJvd3NlclN5bmNJbnN0YW5jZTtcblxuICAgIC8qKlxuICAgICAqIFByb2plY3RXYXRjaGVyIGNvbnN0cnVjdG9yXG4gICAgICogQHNpbmNlIDAuMi4wXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoY29uZmlnUGF0aDogc3RyaW5nLCBidWlsZFBhdGg6IHN0cmluZywgZXZlbnRFbWl0dGVyOiBFdmVudEVtaXR0ZXIpIHtcbiAgICAgICAgdGhpcy5jb25maWdQYXRoID0gY29uZmlnUGF0aDtcbiAgICAgICAgdGhpcy5idWlsZFBhdGggPSBidWlsZFBhdGg7XG4gICAgICAgIHRoaXMuZXZlbnRFbWl0dGVyID0gZXZlbnRFbWl0dGVyO1xuICAgICAgICB0aGlzLnNlcnZlciA9IGJyb3dzZXJTeW5jLmNyZWF0ZSgpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqXG4gICAgICogQHNpbmNlIDAuMi4wXG4gICAgICovXG4gICAgcHVibGljIHN0YXJ0U2VydmVyKCkge1xuICAgICAgICBsZXQgcHJvamVjdFdhdGNoZXIgPSBuZXcgUHJvamVjdFdhdGNoZXIodGhpcy5jb25maWdQYXRoLCB0aGlzLmJ1aWxkUGF0aCwgdGhpcy5ldmVudEVtaXR0ZXIpO1xuICAgICAgICBwcm9qZWN0V2F0Y2hlci53YXRjaCgpO1xuICAgICAgICB0aGlzLnNlcnZlci5pbml0KHtcbiAgICAgICAgICAgIHNlcnZlcjogdGhpcy5idWlsZFBhdGgsXG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLmV2ZW50RW1pdHRlci5vbihCVUlMRF9DSEFOR0VfRVZFTlQsIChmaWxlUGF0aCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXJ2ZXIucmVsb2FkKHBhdGguam9pbih0aGlzLmJ1aWxkUGF0aCwgZmlsZVBhdGgpKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIl19
