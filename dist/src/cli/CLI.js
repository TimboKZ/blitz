"use strict";
var nomnom = require('nomnom');
var path = require('path');
var ProjectInitialiser_1 = require('../core/ProjectInitialiser');
var Logger_1 = require('./Logger');
var Blitz_1 = require('../Blitz');
var ProjectSettings_1 = require('../components/ProjectSettings');
var Util_1 = require('../helpers/Util');
exports.CLI_NAME = 'blitz';
var CLI = (function () {
    function CLI() {
    }
    CLI.run = function (argv) {
        var parser = nomnom();
        global.debug = false;
        global.verbose = false;
        parser.script(exports.CLI_NAME);
        parser.nocommand().callback(function () { return CLI.version(); });
        parser.option('verbose', {
            abbr: 'v',
            flag: true,
            help: 'displays warnings and log output',
            callback: function (flagSet) { return global.verbose = flagSet; },
        });
        parser.option('debug', {
            abbr: 'd',
            flag: true,
            help: 'displays debug output',
            callback: function (flagSet) { return global.debug = flagSet; },
        });
        parser.command('init')
            .option('template', {
            abbr: 't',
            default: ProjectInitialiser_1.DEFAULT_TEMPLATE,
            help: 'template name',
        })
            .option('path', {
            abbr: 'p',
            default: process.cwd(),
            help: 'path to project folder',
        })
            .help('initialise a project from template')
            .callback(function (opts) { return Blitz_1.Blitz.init(opts.template, opts.path); });
        parser.command('build')
            .option('config', {
            abbr: 'c',
            default: path.join(process.cwd(), ProjectSettings_1.DEFAULT_CONFIG_NAME),
            help: 'path to Blitz config',
        })
            .option('build', {
            abbr: 'b',
            default: path.join(process.cwd(), ProjectSettings_1.DEFAULT_BUILD_DIRECTORY_NAME),
            help: 'path to target build directory',
        })
            .help('builds site using `blitz.yml`')
            .callback(function (opts) { return Blitz_1.Blitz.build(opts.config, opts.build); });
        parser.command('watch')
            .option('config', {
            abbr: 'c',
            default: path.join(process.cwd(), ProjectSettings_1.DEFAULT_CONFIG_NAME),
            help: 'path to Blitz config',
        })
            .option('build', {
            abbr: 'b',
            default: path.join(process.cwd(), ProjectSettings_1.DEFAULT_BUILD_DIRECTORY_NAME),
            help: 'path to target build directory',
        })
            .help('watches source code and rebuilds the website when necessary')
            .callback(function (opts) {
            global.verbose = true;
            Blitz_1.Blitz.watch(opts.config, opts.build);
        });
        parser.command('preview')
            .option('config', {
            abbr: 'c',
            default: path.join(process.cwd(), ProjectSettings_1.DEFAULT_CONFIG_NAME),
            help: 'path to Blitz config',
        })
            .option('build', {
            abbr: 'b',
            default: path.join(process.cwd(), ProjectSettings_1.DEFAULT_BUILD_DIRECTORY_NAME),
            help: 'path to target build directory',
        })
            .help('starts a web server for real-time change preview')
            .callback(function (opts) {
            global.verbose = true;
            Blitz_1.Blitz.preview(opts.config, opts.build);
        });
        var normalisedArgv = argv.slice(2);
        exports.args = parser.parse(normalisedArgv);
    };
    CLI.version = function () {
        var verboseState = global.verbose;
        global.verbose = true;
        Logger_1.Logger.log('Blitz v' + Util_1.Util.getPackageInfo().version + ', use `' + Logger_1.Logger.brand('blitz -h') + '` for help');
        Logger_1.Logger.log('For documentation, refer to ' + Logger_1.Logger.brand('https://getblitz.io/'));
        global.verbose = verboseState;
    };
    return CLI;
}());
exports.CLI = CLI;

//# sourceMappingURL=data:application/json;charset=utf8;base64,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QUFnQztTQUN6QyxDQUFDO2FBQ0QsSUFBSSxDQUFDLGtEQUFrRCxDQUFDO2FBQ3hELFFBQVEsQ0FBQyxVQUFDLElBQUk7WUFDWCxNQUFNLENBQUMsT0FBTyxHQUFHLElBQUksQ0FBQztZQUN0QixhQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzNDLENBQUMsQ0FBQyxDQUFDO1FBRVAsSUFBSSxjQUFjLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNuQyxZQUFJLEdBQUcsTUFBTSxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUMsQ0FBQztJQUN4QyxDQUFDO0lBTWEsV0FBTyxHQUFyQjtRQUNJLElBQUksWUFBWSxHQUFHLE1BQU0sQ0FBQyxPQUFPLENBQUM7UUFDbEMsTUFBTSxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUM7UUFDdEIsZUFBTSxDQUFDLEdBQUcsQ0FBQyxTQUFTLEdBQUcsV0FBSSxDQUFDLGNBQWMsRUFBRSxDQUFDLE9BQU8sR0FBRyxTQUFTLEdBQUcsZUFBTSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsR0FBRyxZQUFZLENBQUMsQ0FBQztRQUM1RyxlQUFNLENBQUMsR0FBRyxDQUFDLDhCQUE4QixHQUFHLGVBQU0sQ0FBQyxLQUFLLENBQUMsc0JBQXNCLENBQUMsQ0FBQyxDQUFDO1FBQ2xGLE1BQU0sQ0FBQyxPQUFPLEdBQUcsWUFBWSxDQUFDO0lBQ2xDLENBQUM7SUFDTCxVQUFDO0FBQUQsQ0FuR0EsQUFtR0MsSUFBQTtBQW5HWSxXQUFHLE1BbUdmLENBQUEiLCJmaWxlIjoic3JjL2NsaS9DTEkuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBmaWxlIENvbnRhaW5zIGNvZGUgcmVzcG9uc2libGUgZm9yIHJvdXRpbmcgYGJsaXR6YCBDTEkgY29tbWFuZHMgdG8gdGhlIGBibGl0emAgbW9kdWxlXG4gKiBAYXV0aG9yIFRpbXVyIEt1emhhZ2FsaXlldiA8dGltLmt1emhAZ21haWwuY29tPlxuICogQGNvcHlyaWdodCAyMDE2XG4gKiBAbGljZW5zZSBHUEwtMy4wXG4gKiBAc2luY2UgMC4yLjBcbiAqL1xuXG5pbXBvcnQgKiBhcyBub21ub20gZnJvbSAnbm9tbm9tJztcbmltcG9ydCAqIGFzIHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQge0RFRkFVTFRfVEVNUExBVEV9IGZyb20gJy4uL2NvcmUvUHJvamVjdEluaXRpYWxpc2VyJztcbmltcG9ydCB7TG9nZ2VyfSBmcm9tICcuL0xvZ2dlcic7XG5pbXBvcnQge0JsaXR6fSBmcm9tICcuLi9CbGl0eic7XG5pbXBvcnQge0RFRkFVTFRfQ09ORklHX05BTUUsIERFRkFVTFRfQlVJTERfRElSRUNUT1JZX05BTUV9IGZyb20gJy4uL2NvbXBvbmVudHMvUHJvamVjdFNldHRpbmdzJztcbmltcG9ydCB7fSBmcm9tICcuLi9jb3JlL1NpdGVHZW5lcmF0b3InO1xuaW1wb3J0IHtVdGlsfSBmcm9tICcuLi9oZWxwZXJzL1V0aWwnO1xuXG4vKipcbiAqIE5hbWUgb2YgdGhlIGNsaSBjb21tYW5kIHVzZWQgdG8gcnVuIEJsaXR6XG4gKiBAc2luY2UgMC4yLjBcbiAqL1xuZXhwb3J0IGNvbnN0IENMSV9OQU1FID0gJ2JsaXR6JztcblxuLyoqXG4gKiBQYXJzZWQgYXJndW1lbnRzXG4gKiBAc2luY2UgMC4yLjBcbiAqL1xuZXhwb3J0IGxldCBhcmdzO1xuXG4vKipcbiAqIEBjbGFzcyBFeHBvc2VzIGFuIEFQSSBmb3IgdGhlIGNsaVxuICogQHNpbmNlIDAuMi4wXG4gKi9cbmV4cG9ydCBjbGFzcyBDTEkge1xuICAgIC8qKlxuICAgICAqIFBhcnNlcyBjb21tYW5kIGxpbmUgYXJndW1lbnRzIGFuZCBydW5zIHJlbGV2YW50IG1ldGhvZHNcbiAgICAgKiBAc2luY2UgMC4yLjBcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIHJ1bihhcmd2OiBzdHJpbmdbXSkge1xuICAgICAgICBsZXQgcGFyc2VyID0gbm9tbm9tKCk7XG5cbiAgICAgICAgZ2xvYmFsLmRlYnVnID0gZmFsc2U7XG4gICAgICAgIGdsb2JhbC52ZXJib3NlID0gZmFsc2U7XG5cbiAgICAgICAgcGFyc2VyLnNjcmlwdChDTElfTkFNRSk7XG4gICAgICAgIHBhcnNlci5ub2NvbW1hbmQoKS5jYWxsYmFjaygoKSA9PiBDTEkudmVyc2lvbigpKTtcbiAgICAgICAgcGFyc2VyLm9wdGlvbigndmVyYm9zZScsIHtcbiAgICAgICAgICAgIGFiYnI6ICd2JyxcbiAgICAgICAgICAgIGZsYWc6IHRydWUsXG4gICAgICAgICAgICBoZWxwOiAnZGlzcGxheXMgd2FybmluZ3MgYW5kIGxvZyBvdXRwdXQnLFxuICAgICAgICAgICAgY2FsbGJhY2s6IChmbGFnU2V0KSA9PiBnbG9iYWwudmVyYm9zZSA9IGZsYWdTZXQsXG4gICAgICAgIH0pO1xuICAgICAgICBwYXJzZXIub3B0aW9uKCdkZWJ1ZycsIHtcbiAgICAgICAgICAgIGFiYnI6ICdkJyxcbiAgICAgICAgICAgIGZsYWc6IHRydWUsXG4gICAgICAgICAgICBoZWxwOiAnZGlzcGxheXMgZGVidWcgb3V0cHV0JyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoZmxhZ1NldCkgPT4gZ2xvYmFsLmRlYnVnID0gZmxhZ1NldCxcbiAgICAgICAgfSk7XG4gICAgICAgIHBhcnNlci5jb21tYW5kKCdpbml0JylcbiAgICAgICAgICAgIC5vcHRpb24oJ3RlbXBsYXRlJywge1xuICAgICAgICAgICAgICAgIGFiYnI6ICd0JyxcbiAgICAgICAgICAgICAgICBkZWZhdWx0OiBERUZBVUxUX1RFTVBMQVRFLFxuICAgICAgICAgICAgICAgIGhlbHA6ICd0ZW1wbGF0ZSBuYW1lJyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAub3B0aW9uKCdwYXRoJywge1xuICAgICAgICAgICAgICAgIGFiYnI6ICdwJyxcbiAgICAgICAgICAgICAgICBkZWZhdWx0OiBwcm9jZXNzLmN3ZCgpLFxuICAgICAgICAgICAgICAgIGhlbHA6ICdwYXRoIHRvIHByb2plY3QgZm9sZGVyJyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuaGVscCgnaW5pdGlhbGlzZSBhIHByb2plY3QgZnJvbSB0ZW1wbGF0ZScpXG4gICAgICAgICAgICAuY2FsbGJhY2soKG9wdHMpID0+IEJsaXR6LmluaXQob3B0cy50ZW1wbGF0ZSwgb3B0cy5wYXRoKSk7XG4gICAgICAgIHBhcnNlci5jb21tYW5kKCdidWlsZCcpXG4gICAgICAgICAgICAub3B0aW9uKCdjb25maWcnLCB7XG4gICAgICAgICAgICAgICAgYWJicjogJ2MnLFxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCBERUZBVUxUX0NPTkZJR19OQU1FKSxcbiAgICAgICAgICAgICAgICBoZWxwOiAncGF0aCB0byBCbGl0eiBjb25maWcnLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5vcHRpb24oJ2J1aWxkJywge1xuICAgICAgICAgICAgICAgIGFiYnI6ICdiJyxcbiAgICAgICAgICAgICAgICBkZWZhdWx0OiBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgREVGQVVMVF9CVUlMRF9ESVJFQ1RPUllfTkFNRSksXG4gICAgICAgICAgICAgICAgaGVscDogJ3BhdGggdG8gdGFyZ2V0IGJ1aWxkIGRpcmVjdG9yeScsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmhlbHAoJ2J1aWxkcyBzaXRlIHVzaW5nIGBibGl0ei55bWxgJylcbiAgICAgICAgICAgIC5jYWxsYmFjaygob3B0cykgPT4gQmxpdHouYnVpbGQob3B0cy5jb25maWcsIG9wdHMuYnVpbGQpKTtcbiAgICAgICAgcGFyc2VyLmNvbW1hbmQoJ3dhdGNoJylcbiAgICAgICAgICAgIC5vcHRpb24oJ2NvbmZpZycsIHtcbiAgICAgICAgICAgICAgICBhYmJyOiAnYycsXG4gICAgICAgICAgICAgICAgZGVmYXVsdDogcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIERFRkFVTFRfQ09ORklHX05BTUUpLFxuICAgICAgICAgICAgICAgIGhlbHA6ICdwYXRoIHRvIEJsaXR6IGNvbmZpZycsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLm9wdGlvbignYnVpbGQnLCB7XG4gICAgICAgICAgICAgICAgYWJicjogJ2InLFxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCBERUZBVUxUX0JVSUxEX0RJUkVDVE9SWV9OQU1FKSxcbiAgICAgICAgICAgICAgICBoZWxwOiAncGF0aCB0byB0YXJnZXQgYnVpbGQgZGlyZWN0b3J5JyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuaGVscCgnd2F0Y2hlcyBzb3VyY2UgY29kZSBhbmQgcmVidWlsZHMgdGhlIHdlYnNpdGUgd2hlbiBuZWNlc3NhcnknKVxuICAgICAgICAgICAgLmNhbGxiYWNrKChvcHRzKSA9PiB7XG4gICAgICAgICAgICAgICAgZ2xvYmFsLnZlcmJvc2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIEJsaXR6LndhdGNoKG9wdHMuY29uZmlnLCBvcHRzLmJ1aWxkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICBwYXJzZXIuY29tbWFuZCgncHJldmlldycpXG4gICAgICAgICAgICAub3B0aW9uKCdjb25maWcnLCB7XG4gICAgICAgICAgICAgICAgYWJicjogJ2MnLFxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCBERUZBVUxUX0NPTkZJR19OQU1FKSxcbiAgICAgICAgICAgICAgICBoZWxwOiAncGF0aCB0byBCbGl0eiBjb25maWcnLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5vcHRpb24oJ2J1aWxkJywge1xuICAgICAgICAgICAgICAgIGFiYnI6ICdiJyxcbiAgICAgICAgICAgICAgICBkZWZhdWx0OiBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgREVGQVVMVF9CVUlMRF9ESVJFQ1RPUllfTkFNRSksXG4gICAgICAgICAgICAgICAgaGVscDogJ3BhdGggdG8gdGFyZ2V0IGJ1aWxkIGRpcmVjdG9yeScsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmhlbHAoJ3N0YXJ0cyBhIHdlYiBzZXJ2ZXIgZm9yIHJlYWwtdGltZSBjaGFuZ2UgcHJldmlldycpXG4gICAgICAgICAgICAuY2FsbGJhY2soKG9wdHMpID0+IHtcbiAgICAgICAgICAgICAgICBnbG9iYWwudmVyYm9zZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgQmxpdHoucHJldmlldyhvcHRzLmNvbmZpZywgb3B0cy5idWlsZCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICBsZXQgbm9ybWFsaXNlZEFyZ3YgPSBhcmd2LnNsaWNlKDIpO1xuICAgICAgICBhcmdzID0gcGFyc2VyLnBhcnNlKG5vcm1hbGlzZWRBcmd2KTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBQcmludHMgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHZlcnNpb25cbiAgICAgKiBAc2luY2UgMC4yLjBcbiAgICAgKi9cbiAgICBwdWJsaWMgc3RhdGljIHZlcnNpb24oKSB7XG4gICAgICAgIGxldCB2ZXJib3NlU3RhdGUgPSBnbG9iYWwudmVyYm9zZTtcbiAgICAgICAgZ2xvYmFsLnZlcmJvc2UgPSB0cnVlO1xuICAgICAgICBMb2dnZXIubG9nKCdCbGl0eiB2JyArIFV0aWwuZ2V0UGFja2FnZUluZm8oKS52ZXJzaW9uICsgJywgdXNlIGAnICsgTG9nZ2VyLmJyYW5kKCdibGl0eiAtaCcpICsgJ2AgZm9yIGhlbHAnKTtcbiAgICAgICAgTG9nZ2VyLmxvZygnRm9yIGRvY3VtZW50YXRpb24sIHJlZmVyIHRvICcgKyBMb2dnZXIuYnJhbmQoJ2h0dHBzOi8vZ2V0YmxpdHouaW8vJykpO1xuICAgICAgICBnbG9iYWwudmVyYm9zZSA9IHZlcmJvc2VTdGF0ZTtcbiAgICB9XG59XG4iXX0=
